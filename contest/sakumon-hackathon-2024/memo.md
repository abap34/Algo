# 問題案1

- $N$ 頂点 $K$ 辺のグラフ $G = (V, E)$、

- 各辺 $e \in E$ に対して
  - $w(e)$: 辺 $e$ のコスト
  - $p(e)$: 辺 $e$ の利益 、


- 総コスト $C$ 

が与えられます。


$G$ の全域木 $T$ に対して

- $w(T) = \sum_{e \in T} w(e)$
- $p(T) = \sum_{e \in T} p(e)$

とします。

$w(T) \leq C$ となるような $T$ のうち、 $p(T)$ が最大となるような $T$ を求めてください。 

## 解法

ダメそう.

# 問題案2

- $N$ 頂点 $K$ 辺のグラフ $G = (V, E)$、

- 各辺 $e \in E$ に対して
  - $w(e)$: 辺 $e$ のコスト
  - $p(e)$: 辺 $e$ の利益 


- 総コスト $C$ 


が与えられます。


$G$ の全域木 $T$ に対して

- $w(T) = \sum_{e \in T} w(e)$
- $p(T) = \max \{ p(e) \mid e \in T \}$

とします。

$w(T) \leq C$ となるような $T$ のうち、 $p(T)$ が最大となるような $T$ を求めてください。

## 解法

($p(e)$ が大きい順に) 各 $e$ に対して、 $e$ を含んで $w(T)$ が最小の $T$ を調べて $w(T) \leq C$ ならば、それが答え。

### 1. $O(E^2 \log V)$

$p(e)$ が最大になる $e = (u, v)$ をとって、 $u$ と $v$ につながる辺を全てあたらしい頂点 $w$ につなぎかえて新しい
グラフ $G'$ を作る。　$G'$ に対して最小全域木を求めて制約 $w(T) \leq C$ を満たすならばそれが答え。

そうでなければ、二番目に大きい $p(e)$ をとって、同様に $G''$ を作り, ... と繰り返す。

### 2. $O(E \log V)$ 

$e$ を含んで、 $w(T)$ が最小の $T$ は、 $G$ の最小全域木に $e$ を加えることでできる閉路上の辺のうち、
$w(e')$ が最大になる辺 $e'$ を取り除くことでできる。

なので、 最小全域木のコストを $C_m$ とすると、

$C_m + w(e) - w(e') \leq C$ ならば、 $e$ を加えて $e'$ を取り除いたものが答え。



#### 一般の場合

$w(e')$ が最大になる辺 $e'$ は、 $e = (u, v)$ として、 $u$ と $v$ の最小共通祖先を $r$ とすると、

- $u$ から $r$ までの最大の辺
- $v$ から $r$ までの最大の辺

の大きいほう.

なので、 

- $u$ と $v$ の共通祖先 $r$
- $u$ から $r$ までの最大の辺
- $v$ から $r$ までの最大の辺

を速く求められれば良い。

これは、ダブリングを使って LCA を求めるアルゴリズムをやりながら、

```
dist[u][k] := u　から 2^{k-1}　個の親をたどったときの最大の辺
```

を持っておき、 $r$ へ辿るときに `max` をとりながら進めば $O(\log V)$ で求まる。(あとで書く)




#### なんかグラフに制約を与えて簡単なアルゴリズムで速くできない？

むりそう





# 問題案5

$k$ 番目に小さい最小全域木を求める問題


